[2022-09-21 03:23:51,685] WARN Client session timed out, have not heard from server in 29440ms for session id 0x1000550ad290001 (org.apache.zookeeper.ClientCnxn)
[2022-09-21 03:23:51,925] WARN Session 0x1000550ad290001 for sever localhost/127.0.0.1:2181, Closing socket connection. Attempting reconnect except it is a SessionExpiredException. (org.apache.zookeeper.ClientCnxn)
org.apache.zookeeper.ClientCnxn$SessionTimeoutException: Client session timed out, have not heard from server in 29440ms for session id 0x1000550ad290001
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1258)
[2022-09-21 03:23:53,840] INFO Opening socket connection to server localhost/[0:0:0:0:0:0:0:1]:2181. (org.apache.zookeeper.ClientCnxn)
[2022-09-21 03:23:53,848] INFO Socket connection established, initiating session, client: /[0:0:0:0:0:0:0:1]:64037, server: localhost/[0:0:0:0:0:0:0:1]:2181 (org.apache.zookeeper.ClientCnxn)
[2022-09-21 03:23:53,922] WARN Unable to reconnect to ZooKeeper service, session 0x1000550ad290001 has expired (org.apache.zookeeper.ClientCnxn)
[2022-09-21 03:23:53,943] INFO [ZooKeeperClient Kafka server] Session expired. (kafka.zookeeper.ZooKeeperClient)
[2022-09-21 03:23:53,947] WARN Session 0x1000550ad290001 for sever localhost/[0:0:0:0:0:0:0:1]:2181, Closing socket connection. Attempting reconnect except it is a SessionExpiredException. (org.apache.zookeeper.ClientCnxn)
org.apache.zookeeper.ClientCnxn$SessionExpiredException: Unable to reconnect to ZooKeeper service, session 0x1000550ad290001 has expired
	at org.apache.zookeeper.ClientCnxn$SendThread.onConnected(ClientCnxn.java:1434)
	at org.apache.zookeeper.ClientCnxnSocket.readConnectResult(ClientCnxnSocket.java:154)
	at org.apache.zookeeper.ClientCnxnSocketNIO.doIO(ClientCnxnSocketNIO.java:86)
	at org.apache.zookeeper.ClientCnxnSocketNIO.doTransport(ClientCnxnSocketNIO.java:350)
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1290)
[2022-09-21 03:23:53,940] INFO EventThread shut down for session: 0x1000550ad290001 (org.apache.zookeeper.ClientCnxn)
[2022-09-21 03:23:53,973] INFO [ZooKeeperClient Kafka server] Initializing a new session to localhost:2181. (kafka.zookeeper.ZooKeeperClient)
[2022-09-21 03:23:53,984] INFO Initiating client connection, connectString=localhost:2181 sessionTimeout=18000 watcher=kafka.zookeeper.ZooKeeperClient$ZooKeeperClientWatcher$@7a3793c7 (org.apache.zookeeper.ZooKeeper)
[2022-09-21 03:23:54,019] INFO jute.maxbuffer value is 4194304 Bytes (org.apache.zookeeper.ClientCnxnSocket)
[2022-09-21 03:23:54,049] INFO zookeeper.request.timeout value is 0. feature enabled=false (org.apache.zookeeper.ClientCnxn)
[2022-09-21 03:23:54,062] INFO Opening socket connection to server localhost/127.0.0.1:2181. (org.apache.zookeeper.ClientCnxn)
[2022-09-21 03:23:54,083] INFO Socket connection established, initiating session, client: /127.0.0.1:64039, server: localhost/127.0.0.1:2181 (org.apache.zookeeper.ClientCnxn)
[2022-09-21 03:23:54,176] INFO Creating /brokers/ids/2 (is it secure? false) (kafka.zk.KafkaZkClient)
[2022-09-21 03:23:54,275] INFO Session establishment complete on server localhost/127.0.0.1:2181, session id = 0x1000550ad290004, negotiated timeout = 18000 (org.apache.zookeeper.ClientCnxn)
[2022-09-21 03:23:54,364] INFO Processing notification(s) to /config/changes (kafka.common.ZkNodeChangeNotificationListener)
[2022-09-21 03:23:54,376] INFO Updated cache from existing FinalizedFeaturesAndEpoch(features=Features{}, epoch=0) to latest FinalizedFeaturesAndEpoch(features=Features{}, epoch=0). (kafka.server.FinalizedFeatureCache)
[2022-09-21 03:23:54,422] INFO Stat of the created znode at /brokers/ids/2 is: 454,454,1663705434314,1663705434314,1,0,0,72063438098595844,202,0,454
 (kafka.zk.KafkaZkClient)
[2022-09-21 03:23:54,439] INFO Registered broker 2 at path /brokers/ids/2 with addresses: PLAINTEXT://localhost:9094, czxid (broker epoch): 454 (kafka.zk.KafkaZkClient)
[2022-09-21 03:23:55,798] INFO [ReplicaFetcherManager on broker 2] Removed fetcher for partitions Set(animal-1, animal-4) (kafka.server.ReplicaFetcherManager)
[2022-09-21 03:23:55,875] INFO [ReplicaFetcher replicaId=2, leaderId=1, fetcherId=0] Partition animal-3 has an older epoch (0) than the current leader. Will await the new LeaderAndIsr state before resuming fetching. (kafka.server.ReplicaFetcherThread)
[2022-09-21 03:23:55,879] WARN [ReplicaFetcher replicaId=2, leaderId=1, fetcherId=0] Partition animal-3 marked as failed (kafka.server.ReplicaFetcherThread)
[2022-09-21 03:23:55,979] INFO [ReplicaFetcher replicaId=2, leaderId=1, fetcherId=0] Partition animal-0 has an older epoch (0) than the current leader. Will await the new LeaderAndIsr state before resuming fetching. (kafka.server.ReplicaFetcherThread)
[2022-09-21 03:23:55,996] WARN [ReplicaFetcher replicaId=2, leaderId=1, fetcherId=0] Partition animal-0 marked as failed (kafka.server.ReplicaFetcherThread)
[2022-09-21 03:23:56,003] INFO [ReplicaFetcherManager on broker 2] Removed fetcher for partitions HashSet(animal-0, animal-3) (kafka.server.ReplicaFetcherManager)
[2022-09-21 03:23:56,007] INFO [ReplicaFetcherManager on broker 2] Added fetcher to broker 1 for partitions Map(animal-0 -> InitialFetchState(Some(bs1dbs3lT1OkjYLH8gJeXA),BrokerEndPoint(id=1, host=localhost:9093),1,71), animal-3 -> InitialFetchState(Some(bs1dbs3lT1OkjYLH8gJeXA),BrokerEndPoint(id=1, host=localhost:9093),1,71)) (kafka.server.ReplicaFetcherManager)
[2022-09-21 03:23:56,058] INFO [ReplicaFetcherManager on broker 2] Removed fetcher for partitions HashSet(animal-2) (kafka.server.ReplicaFetcherManager)
[2022-09-21 03:23:56,059] INFO [ReplicaFetcherManager on broker 2] Added fetcher to broker 1 for partitions Map(animal-2 -> InitialFetchState(Some(bs1dbs3lT1OkjYLH8gJeXA),BrokerEndPoint(id=1, host=localhost:9093),2,70)) (kafka.server.ReplicaFetcherManager)
[2022-09-21 03:23:56,079] INFO [ReplicaFetcher replicaId=2, leaderId=3, fetcherId=0] Shutting down (kafka.server.ReplicaFetcherThread)
[2022-09-21 03:23:56,100] INFO [ReplicaFetcher replicaId=2, leaderId=3, fetcherId=0] Client requested connection close from node 3 (org.apache.kafka.clients.NetworkClient)
[2022-09-21 03:23:56,115] INFO [ReplicaFetcher replicaId=2, leaderId=3, fetcherId=0] Cancelled in-flight FETCH request with correlation id 8068 due to node 3 being disconnected (elapsed time since creation: 203ms, elapsed time since send: 203ms, request timeout: 30000ms) (org.apache.kafka.clients.NetworkClient)
[2022-09-21 03:23:56,116] INFO [ReplicaFetcher replicaId=2, leaderId=3, fetcherId=0] Error sending fetch request (sessionId=715958965, epoch=8068) to node 3: (org.apache.kafka.clients.FetchSessionHandler)
java.io.IOException: Client was shutdown before response was read
	at org.apache.kafka.clients.NetworkClientUtils.sendAndReceive(NetworkClientUtils.java:108)
	at kafka.server.ReplicaFetcherBlockingSend.sendRequest(ReplicaFetcherBlockingSend.scala:109)
	at kafka.server.ReplicaFetcherThread.fetchFromLeader(ReplicaFetcherThread.scala:219)
	at kafka.server.AbstractFetcherThread.processFetchRequest(AbstractFetcherThread.scala:322)
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3(AbstractFetcherThread.scala:137)
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3$adapted(AbstractFetcherThread.scala:136)
	at scala.Option.foreach(Option.scala:437)
	at kafka.server.AbstractFetcherThread.maybeFetch(AbstractFetcherThread.scala:136)
	at kafka.server.AbstractFetcherThread.doWork(AbstractFetcherThread.scala:119)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-09-21 03:23:56,132] INFO [ReplicaFetcher replicaId=2, leaderId=3, fetcherId=0] Stopped (kafka.server.ReplicaFetcherThread)
[2022-09-21 03:23:56,132] INFO [ReplicaFetcher replicaId=2, leaderId=3, fetcherId=0] Shutdown completed (kafka.server.ReplicaFetcherThread)
[2022-09-21 03:23:56,275] INFO [Partition animal-4 broker=2] ISR updated to 2,1,3 and version updated to 2 (kafka.cluster.Partition)
[2022-09-21 03:23:56,317] INFO [Partition animal-1 broker=2] ISR updated to 2,1,3 and version updated to 2 (kafka.cluster.Partition)
