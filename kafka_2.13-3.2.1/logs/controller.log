[2022-09-21 18:02:15,227] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker localhost:9095 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9095 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-09-21 18:02:15,227] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker localhost:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-09-21 18:02:15,227] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker localhost:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-09-21 18:02:15,298] TRACE [Controller id=1] All leaders = __consumer_offsets-13 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-46 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-9 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-42 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-21 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-17 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-30 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-26 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),animal-1 -> (Leader:2,ISR:2,1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:3,ControllerEpoch:5),__consumer_offsets-5 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-38 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),first_topic-3 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-1 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-34 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-16 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-45 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-12 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),first_topic-1 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-41 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-24 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-20 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-49 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-0 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-29 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-25 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-8 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-37 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),first_topic-2 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-4 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),animal-2 -> (Leader:1,ISR:1,2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:5,ControllerEpoch:5),__consumer_offsets-33 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-15 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-48 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-11 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),first_topic-0 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-44 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-23 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-19 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-32 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-28 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-7 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-40 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-3 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-36 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),animal-3 -> (Leader:1,ISR:1,2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:3,ControllerEpoch:5),__consumer_offsets-47 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-14 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-43 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-10 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-22 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-18 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-31 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-27 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),animal-0 -> (Leader:1,ISR:1,2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:3,ControllerEpoch:5),__consumer_offsets-39 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),first_topic-4 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-6 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),animal-4 -> (Leader:2,ISR:2,1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:3,ControllerEpoch:5),__consumer_offsets-35 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-2 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5) (kafka.controller.KafkaController)
[2022-09-21 18:02:15,308] INFO [ControllerEventThread controllerId=1] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-09-21 18:02:15,309] INFO [ControllerEventThread controllerId=1] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-09-21 18:02:15,310] DEBUG [Controller id=1] Resigning (kafka.controller.KafkaController)
[2022-09-21 18:02:15,314] DEBUG [Controller id=1] Unregister BrokerModifications handler for Set(1, 2, 3) (kafka.controller.KafkaController)
[2022-09-21 18:02:15,316] INFO [PartitionStateMachine controllerId=1] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2022-09-21 18:02:15,318] INFO [ReplicaStateMachine controllerId=1] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2022-09-21 18:02:15,319] INFO [RequestSendThread controllerId=1] Shutting down (kafka.controller.RequestSendThread)
[2022-09-21 18:02:15,323] WARN [RequestSendThread controllerId=1] Controller 1 epoch 5 fails to send request (type=LeaderAndIsRequest, controllerId=1, controllerEpoch=5, brokerEpoch=453, partitionStates=[LeaderAndIsrPartitionState(topicName='animal', partitionIndex=2, controllerEpoch=5, leader=1, leaderEpoch=4, isr=[1, 2], zkVersion=5, replicas=[3, 1, 2], addingReplicas=[], removingReplicas=[], isNew=false, leaderRecoveryState=0)], topicIds={animal=bs1dbs3lT1OkjYLH8gJeXA}, liveLeaders=(localhost:9093 (id: 1 rack: null))) to broker localhost:9093 (id: 1 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.tryAcquireSharedNanos(AbstractQueuedSynchronizer.java:1081)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:276)
	at kafka.utils.ShutdownableThread.pause(ShutdownableThread.scala:82)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:233)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-09-21 18:02:15,327] TRACE [RequestSendThread controllerId=1] shutdownInitiated latch count reached zero. Shutdown called. (kafka.controller.RequestSendThread)
[2022-09-21 18:02:15,327] INFO [RequestSendThread controllerId=1] Shutdown completed (kafka.controller.RequestSendThread)
[2022-09-21 18:02:15,327] INFO [RequestSendThread controllerId=1] Stopped (kafka.controller.RequestSendThread)
[2022-09-21 18:02:15,336] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker localhost:9095 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9095 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-09-21 18:02:15,336] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker localhost:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-09-21 18:02:15,336] INFO [RequestSendThread controllerId=1] Shutting down (kafka.controller.RequestSendThread)
[2022-09-21 18:02:15,337] WARN [RequestSendThread controllerId=1] Controller 1 epoch 5 fails to send request (type=LeaderAndIsRequest, controllerId=1, controllerEpoch=5, brokerEpoch=454, partitionStates=[LeaderAndIsrPartitionState(topicName='animal', partitionIndex=2, controllerEpoch=5, leader=1, leaderEpoch=4, isr=[1, 2], zkVersion=5, replicas=[3, 1, 2], addingReplicas=[], removingReplicas=[], isNew=false, leaderRecoveryState=0)], topicIds={animal=bs1dbs3lT1OkjYLH8gJeXA}, liveLeaders=(localhost:9093 (id: 1 rack: null))) to broker localhost:9094 (id: 2 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.tryAcquireSharedNanos(AbstractQueuedSynchronizer.java:1081)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:276)
	at kafka.utils.ShutdownableThread.pause(ShutdownableThread.scala:82)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:233)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-09-21 18:02:15,402] TRACE [RequestSendThread controllerId=1] shutdownInitiated latch count reached zero. Shutdown called. (kafka.controller.RequestSendThread)
[2022-09-21 18:02:15,402] INFO [RequestSendThread controllerId=1] Stopped (kafka.controller.RequestSendThread)
[2022-09-21 18:02:15,403] INFO [RequestSendThread controllerId=1] Shutdown completed (kafka.controller.RequestSendThread)
[2022-09-21 18:02:15,411] INFO [RequestSendThread controllerId=1] Shutting down (kafka.controller.RequestSendThread)
[2022-09-21 18:02:15,412] WARN [RequestSendThread controllerId=1] Controller 1 epoch 5 fails to send request (type=LeaderAndIsRequest, controllerId=1, controllerEpoch=5, brokerEpoch=459, partitionStates=[LeaderAndIsrPartitionState(topicName='animal', partitionIndex=2, controllerEpoch=5, leader=1, leaderEpoch=4, isr=[1, 2], zkVersion=5, replicas=[3, 1, 2], addingReplicas=[], removingReplicas=[], isNew=false, leaderRecoveryState=0)], topicIds={animal=bs1dbs3lT1OkjYLH8gJeXA}, liveLeaders=(localhost:9093 (id: 1 rack: null))) to broker localhost:9095 (id: 3 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.tryAcquireSharedNanos(AbstractQueuedSynchronizer.java:1081)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:276)
	at kafka.utils.ShutdownableThread.pause(ShutdownableThread.scala:82)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:233)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-09-21 18:02:15,415] TRACE [RequestSendThread controllerId=1] shutdownInitiated latch count reached zero. Shutdown called. (kafka.controller.RequestSendThread)
[2022-09-21 18:02:15,415] INFO [RequestSendThread controllerId=1] Stopped (kafka.controller.RequestSendThread)
[2022-09-21 18:02:15,415] INFO [RequestSendThread controllerId=1] Shutdown completed (kafka.controller.RequestSendThread)
[2022-09-21 18:02:15,428] INFO [Controller id=1] Resigned (kafka.controller.KafkaController)
